[["index.html", "Módulo Calidad de Aguas Iber Down the rabbit-hole", " Módulo Calidad de Aguas Iber Renán Pulquillanca 2021-07-23 Down the rabbit-hole "],["intro.html", "Chapter 1 Introducción", " Chapter 1 Introducción Iber es un modelo numérico de simulación de flujo turbulento en lámina libre en régimen no-permanente, y de procesos medioambientales en hidráulica fluvial. El modelo consta de distintos módulos entre los que se encuentran los siguientes: hidrodinámica, calidad de aguas, turbulencia, transporte de sedimentos por carga de fondo y en suspensión. Todos los módulos están basados en ecuaciones de transporte bidimensionales promediadas en profundidad. En este manual se realiza una descripción de las ecuaciones y modelos incluidos en el módulo de calidad de aguas de Iber, el cual permite predecir la evolución temporal y espacial de las concentraciones de las siguientes variables: Temperatura Salinidad Demanda biológica de oxígeno carbonosa Nitrógeno (orgánico, amoniacal, nitritos y nitratos) Fósforo (orgánico e inorgánico) Fitoplancton Oxígeno disuelto Escherichia Coli (E. Coli) pH Metales El módulo de calidad de aguas de Iber ha sido desarrollado en su totalidad por miembros del Grupo de Ingeniería del Agua y del Medio Ambiente (GEAMA) de la Universidade da Coruña (UdC) y del Instituto FLUMEN (Universitat Politécnica de Catalunya, UPC, y Centro Internacional de Métodos Numéricos en Ingeniería, CIMNE). "],["esquema-del-módulo-de-calidad-de-aguas.html", "Chapter 2 Esquema del Módulo de Calidad de Aguas 2.1 Ecuaciones de transporte 2.2 Términos de dispersión por oleaje 2.3 Términos fuente", " Chapter 2 Esquema del Módulo de Calidad de Aguas Para plantear totalmente el problema de la evolución de un contaminante se deben considerar simultáneamente todas las especies que interaccionan entre sí mediante fenómenos físicos, químicos o biológicos. No obstante, en ocasiones es posible despreciar ciertos procesos, bien por su escasa influencia en un caso concreto o bien en una primera aproximación al problema. La Figura 2.1 muestra de forma esquemática la interacción entre las distintas componentes del módulo de calidad de aguas de Iber. Figure 2.1: Esquema completo del modelo de calidad de aguas. Las flechas indican generación/destrucción/transformación de variables. La salinidad y la alcalinidad se modelan como variables conservativas.. La temperatura del agua influye en prácticamente todas las cinéticas de reacción que se muestran en la Figura 1. Es posible calcularla en el modelo a partir de datos meteorológicos o bien introducirla como dato de entrada. Por su parte, la salinidad influye en la concentración de saturación de oxígeno disuelto y en la tasa de desaparición bacteriana, y puede asimismo calcularse con el modelo o introducirse como dato por el usuario. El modelo resuelve por lo tanto 14 ecuaciones de transporte, una para cada una de las variables mostradas en la Figura 1. Además, a partir de la combinación del carbono orgánico total y de la alcalinidad, el modelo puede estimar el pH del agua. Asimismo, a partir de la salinidad (o sólidos totales disueltos), el usuario puede estimar la conductividad del agua. 2.1 Ecuaciones de transporte Para cada una de las componentes anteriores se resuelve, por medio del método de volúmenes finitos, una ecuación de conservación de masa 2D promediada en profundidad, que se puede escribir en forma: \\[\\begin{equation} \\frac{\\partial}{\\partial t}(hC) + \\frac{\\partial}{\\partial x}(hU_xC) + \\frac{\\partial}{\\partial Y}(hU_yC) = \\frac{\\partial F_{d,x} }{\\partial x}+ \\frac{\\partial F_{d,x}}{\\partial x}+ S_ch \\tag{2.1} \\end{equation}\\] donde \\(C\\) es la concentración de la variable considerada (promediada en profundidad), \\(h\\) es el calado, (\\(U_x\\), \\(U_y\\) ) son las dos componentes de la velocidad del agua promediadas en profundidad, \\(S_c\\) es un término fuente/sumidero que modela la generación/degradación de la sustancia considerada, y (\\(F_{d,x}\\), \\(F_{d,y}\\)) son flujos difusivos/dispersivos que modelan la mezcla debido a efectos como la difusión laminar, turbulencia o dispersión por oleaje. La difusión turbulenta se asume isótropa y proporcional al coeficiente de viscosidad turbulenta calculado en el módulo hidrodinámico. Por el contrario, la dispersión por acción del oleaje se produce fundamentalmente en la dirección de propagación del oleaje y por lo tanto el coeficiente de dispersión por oleaje es anisótropo. Las 2 componentes del flujo por difusión/dispersión se calculan como: \\[\\begin{equation} F_{d,x}= h(\\Gamma_m + \\frac{\\nu_t}{S_{c,t}}) \\frac{\\partial C}{\\partial x} + hD_{xx}\\frac{\\partial C}{\\partial x} + hD_{xy}\\frac{\\partial C}{\\partial y} \\tag{2.2} \\end{equation}\\] \\[\\begin{equation} F_{d,y}= h(\\Gamma_m + \\frac{\\nu_t}{S_{c,t}}) \\frac{\\partial C}{\\partial y} + hD_{yx}\\frac{\\partial C}{\\partial x} + hD_{yy}\\frac{\\partial C}{\\partial y} \\tag{2.3} \\end{equation}\\] \\[\\begin{equation} D_{xx}=D_l \\cdot cos^2\\alpha \\tag{2.4} \\end{equation}\\] \\[\\begin{equation} D_{xy}= D_{yx}=D_l \\cdot cos^2\\alpha \\cdot sin\\alpha \\tag{2.5} \\end{equation}\\] \\[\\begin{equation} D_{yy}=D_l \\cdot sin^2\\alpha \\tag{2.6} \\end{equation}\\] donde \\(\\Gamma_m\\) es el coeficiente de difusión molecular, \\(\\nu_t\\) es la viscosidad turbulenta, \\(S_{c,t}\\) es el número de Schmidt turbulento, que relaciona el coeficiente de difusión turbulenta de momento con el coeficiente de difusión turbulenta de la sustancia considerada, \\(D_{l}\\) es el coeficiente longitudinal de dispersión por oleaje, \\(\\alpha\\) es el ángulo que forma la dirección de propagación del oleaje con el eje \\(x\\). 2.2 Términos de dispersión por oleaje Con el coeficiente longitudinal de dispersión por oleaje se modeliza la dispersión de solutos generada por la acción del oleaje, la cual se produce fundamentalmente debido a 2 factores: 1) el movimiento oscilatorio de las partículas bajo la ola con un período igual al período del oleaje; 2) el perfil vertical de velocidad media bajo la ola. En general, la dispersión introducida por el perfil de velocidad media bajo la ola es más importante que el movimiento oscilatorio de las partículas, debido a que el período del oleaje es por lo general mucho menor que el tiempo necesario para que el soluto se disperse a lo largo de toda la columna de agua (Fischer, 1979; Law,2000). En Iber se incorpora la formulación propuesta por Law (2000) para el cálculo del coeficiente de dispersión longitudinal \\(D_l\\) como: \\[\\begin{equation} D_l= \\frac{H^4}{T^2\\Gamma_2}f_v \\tag{2.7} \\end{equation}\\] \\[\\begin{equation} \\Gamma_e = \\Gamma_m + \\frac{\\nu_t}{S_c} \\tag{2.8} \\end{equation}\\] donde \\(H\\) es la altura de ola, \\(T\\) el período del oleaje, \\(\\Gamma_e\\) el coeficiente de difusividad efectivo (molecular y turbulento) en dirección vertical, y \\(f_v\\) es una función que depende de la relación entre el calado y la longitud de onda del oleaje (Figura 2). 2.3 Términos fuente La interacción entre las distintas sustancias consideradas en el modelo mediante fenómenos físicos, químicos y biológicos se modela mediante el término fuente \\(S_c\\).. Las distintas transformaciones se modelan mediante cinéticas de primer orden: \\[\\begin{equation} S_c =k(T) \\cdot C \\tag{2.9} \\end{equation}\\] donde \\(S\\) es el término fuente/sumidero, \\(k(T)\\) es la constante de reacción (depende de la temperatura) y \\(C\\) es la concentración de la variable considerada. El efecto de la temperatura se introduce en el valor de la constante cinética \\(k\\) mediante el modelo de Arrhenius, según: \\[\\begin{equation} k(T) = k(20)\\cdot \\theta^{(T-20)} \\tag{2.10} \\end{equation}\\] donde \\(k(20)\\) es la constante cinética de reacción a \\(20ºC\\), \\(T\\) es la temperatura del agua en \\(ºC\\) y \\(\\theta\\) es el coeficiente de corrección por temperatura. Los valores del coeficiente \\(\\theta\\) para cada reacción utilizados en Iber se muestran en la sección 9. "],["modelo-de-salinidad.html", "Chapter 3 Modelo de Salinidad", " Chapter 3 Modelo de Salinidad El modelo de salinidad resuelve la ecuación de transporte de sal promediada en profundidad en régimen no permanente, utilizando para ello el campo de velocidades y de turbulencia proporcionado por los módulos correspondientes. Como la sal es una sustancia conservativa (no reacciona con otras sustancias), la ecuación de transporte correspondiente a la salinidad no incluye términos fuente: \\[\\begin{equation} S_c=0 \\tag{3.1} \\end{equation}\\] La ecuación de transporte de sal asume una mezcla perfecta en profundidad de la sal (concentración de sal constante en la vertical), lo cual no es válido en estuarios estratificados, en donde se produce un flujo bicapa en el que el agua dulce del río, más ligera, fluye sobre el agua de mar más pesada, produciéndose gradientes de salinidad y velocidad importantes en la vertical. "],["modelo-de-temperatura.html", "Chapter 4 Modelo de temperatura 4.1 Radiación neta incidente 4.2 Radiación de onda larga emitida por el agua 4.3 Calor transferido por conducción entre el aire y el 4.4 Transferencia de energía en la evaporación y condensación del agua", " Chapter 4 Modelo de temperatura Además del propio interés que puede tener predecir la temperatura del agua para evitar la contaminación térmica, todas las reacciones bioquímicas que afectan a la concentración de los distintos componentes del modelo dependen de la temperatura. En el modelo de temperatura el término fuente incluido en la ecuación de conservación del calor promediada en profundidad es el siguiente: \\[\\begin{equation} S_T=\\frac{Q}{\\rho C_{pw}} \\tag{4.1} \\end{equation}\\] donde \\(C_{pw}\\) es el calor específico del agua, \\(\\rho\\) es la densidad del agua y \\(q\\) es el flujo neto de calor entre aire y agua. El término \\(S_T\\) representa las transferencias de calor a través de la interface aire-agua. Este intercambio de calor puede realizarse por radiación, evaporación y conducción, siendo el flujo neto de calor q la suma algebraica de los diversos flujos de energía: \\[\\begin{equation} Q= Q_{rad} - Q_{br} - Q_{cond} - Q_{evap} \\tag{4.2} \\end{equation}\\] donde \\(q_{rad}\\) es la radiación neta incidente (\\(W/m^42\\)), que comprende la radiación solar de onda corta y la radiación atmosférica de onda larga, \\(q_{br}\\) es la radiación de onda larga emitida por el agua, \\(q_{cond}\\) es el calor transferido por conducción entre el aire y el agua y \\(q_{evap}\\) es la transferencia de energía por evaporación/condensación del agua. A continuación se detalla cómo se calculan e introducen dichos términos en Iber. 4.1 Radiación neta incidente El valor de la radiación neta incidente a través de la superficie del agua debe imponerlo directamente el usuario como dato de entrada en \\(W/m^2\\). Dicha radiación comprende la radiación solar neta de onda corta y la radiación atmosférica neta de onda larga y es siempre un flujo de calor positivo (aumenta la temperatura de la masa de agua). 4.2 Radiación de onda larga emitida por el agua La radiación de onda larga emitida por el agua (qbr) se calcula con la Ley de Stefan-Boltzmann: \\[\\begin{equation} q_{br}=\\varepsilon \\sigma T^4 \\tag{4.2} \\end{equation}\\] donde \\(T\\) es la temperatura del agua en grados Kelvin, \\(\\varepsilon\\) es el factor de emisividad del agua (=0.97) y \\(\\sigma\\) es la constante de Stefan-Boltzmann (=\\(5.669·10^{-8}\\) \\(W/(m^2K^2)\\)) 4.3 Calor transferido por conducción entre el aire y el El calor transferido por conducción se calcula mediante la siguiente expresión: \\[\\begin{equation} q_{cond} = c_1 f(v_{viento})(T-T_{aire}) \\tag{4.3} \\end{equation}\\] donde \\(q_{cond}\\) es el calor transferido por conducción entre el aire y el agua expresado en \\(cal/cm^2/d\\), \\(c_1\\) es el coeficiente de Bowen (=0.47 mmHg/°C) (Chapra, 1997), \\(f(v_{viento)}\\) es una función que define la dependencia de la transferencia de calor con la velocidad del viento, \\(T\\) es la temperatura del agua y \\(T_{aire}\\) la temperatura del aire. La función \\(f(v_{viento})\\) se calcula con la formulación de Brady et al. (1969) a partir de la velocidad del viento en \\(m/s\\) a 7m de altura como: \\[\\begin{equation} f(v_{viento})=19+0.95v^2_{viento 7m} \\tag{4.4} \\end{equation}\\] 4.4 Transferencia de energía en la evaporación y condensación del agua La transferencia de energía en la evaporación/condensación se calcula mediante la ley de Dalton: \\[\\begin{equation} q_{evap} = f(v_{viento}) (e_{agua}-e_{aire}) \\tag{4.5} \\end{equation}\\] \\[\\begin{equation} f(v_{viento}) = 19+0.95v^2_{viento 7m} \\tag{4.6} \\end{equation}\\] donde \\(q_{evap}\\) es la energía empleada por evaporación del agua expresada en \\(cal/cm^2/d\\), \\(e_{agua}\\) es la presión de vapor de saturación a la temperatura del agua en mmHg, y \\(e_{aire}\\) es la presión de vapor del aire en mmHg. Ambas presiones de vapor se calculan según Raudkivi (1979) como: \\[\\begin{equation} e_{agua}=4.596 \\cdot e^{\\frac{17.27T}{237.3+T}} \\tag{4.7} \\end{equation}\\] \\[\\begin{equation} e_{aire}=4.596 \\cdot \\xi \\cdot e^{\\frac{17.27T_{aire}}{237.3+T_{aire}}} \\tag{4.7} \\end{equation}\\] donde \\(\\xi\\) es la humedad relativa del aire en tanto por uno "],["fitoplancton.html", "Chapter 5 Fitoplancton 5.1 Fotosíntesis", " Chapter 5 Fitoplancton Se denomina fitoplancton al conjunto de los organismos del plancton que tienen capacidad fotosintética. Se estudian como algas, pero se clasifican como bacterias o protistas. El grupo más grande que existe es el de las diatomeas. Esta comunidad de organismos microscópicos es la base de la cadena de alimentación de los ecosistemas acuáticos. Además, es el principal responsable de la producción de oxígeno en el planeta. Figure 5.1: El desarrollo excesivo del fitoplancton provoca la acumulación de toxinas que contaminan los ecosistemas marinos El fitoplancton es uno de los componentes centrales del módulo de calidad de aguas ya que influye, por medio de los procesos de fotosíntesis, respiración y muerte, en los balances de masas de los siguientes componentes: Oxígeno disuelto Nitrógeno orgánico Nitrógeno amoniacal Nitratos Fósforo orgánico e inorgánico Carbono inorgánico En el caso de no existir fitoplancton o de no modelarse, los procesos anteriores no se consideran en el modelo, pudiéndose en cualquier caso calcular el resto de sustancias sin considerar el fitoplancton. Por lo tanto, no es imprescindible activar el módelo de fitoplancton para calcular el resto de componentes del módulo de calidad de aguas. El fitoplancton se representa en el modelo por medio de la concentración de clorofila-A (Chl-A). Si se modela el fitoplancton es necesario que el usuario defina su estequiometría, i.e. la relación entre nitrógeno, fósforo, carbono y Chl-A en el fitoplancton, ya que de ello dependen los balances de masa de dichos componentes del modelo. Los ratios que es necesario definir son los siguiente: \\[ r_{na}=\\frac{mg \\ N}{mg\\ A} \\] \\[ r_{pa}=\\frac{mg \\ P}{mg A} \\] \\[ r_{na}=\\frac{mg\\ N}{mg \\ A} \\] donde \\(N\\), \\(P\\), \\(O\\), \\(C\\) y \\(A\\) representan la masa seca de nitrógeno, fósforo, oxígeno, carbono y Chl-A en el fitoplancton. Asimismo, el usuario debe definir la masa de oxígeno generada/consumida por cada gramo de fitoplancton durante los procesos de fotosíntesis y respiración del fitoplancton: \\[ r_{oa}=\\frac{mg\\ O}{mg \\ A} \\] En función del sustrato utilizado en la fotosíntesis (amonio o nitratos), la relación entre \\(r_{oa}\\) y \\(r_{ca}\\) oscila entre 2.67 (sustrato amonio) y 3.47 (sustrato nitratos). Es decir, \\(r_{oa} \\approx 3r_{ca}\\). En el balance de masa de fitoplancton se consideran los siguientes procesos: Fotosíntesis Respiración Muerte Sedimentación La masa de fitoplancton incrementa mediante el proceso de fotosíntesis, y se pierde mediante los procesos de respiración, muerte y sedimentación. En la ecuación de balance de masa del fitoplancton se considera un término fuente por cada uno de estos procesos: \\[\\begin{equation} S_A =S^{foto}_A - S^{resp}_A -S^{muerte}_A - S^{sed}_A \\tag{5.1} \\end{equation}\\] Dichos procesos se modelan mediante las formulaciones que se describen a continuación. 5.1 Fotosíntesis La fotosíntesis es el proceso químico a través del cual las plantas con clorofila transforman materia inorgánica (nutrientes) en materia orgánica gracias a la energía de la luz. En el caso del fitoplancton, los nutrientes son el amonio, nitratos, fosfatos y dióxido de carbono. Las reacciones químicas que representan el proceso de fotosíntesis son las siguientes (una u otra en función de si el sustrato para realizar la fotosíntesis es el amonio o los nitratos): \\[\\begin{equation} 106CO_2+16NH^+_4 + HPO^{2-}_4 + 106 H_{2}O \\longrightarrow C_{106} H_{263} O_{110} N_{16} P + 106 O_2 + 14H^+ \\tag{5.2} \\end{equation}\\] \\[\\begin{equation} 106CO_2+16NO^-_4 + HPO^{2-}_4 + 122 H_{2}O + 18H^+ \\longrightarrow C_{106} H_{263} O_{110} N_{16} P + 138 O_2 \\tag{5.3} \\end{equation}\\] En donde la primera reacción representa la fotosíntesis utilizando amonio como nutriente, y la segunda utilizando nitratos como nutriente. La fotosíntesis se representa en el balance de masa del fitoplancton mediante el siguiente término fuente: \\[\\begin{equation} S^{foto}_A= \\mu_{max} A F_{NPC} F_L \\theta^{(T-20)}_4 \\tag{5.4} \\end{equation}\\] donde \\(\\mu_{max}\\) es la máxima tasa de fotosíntesis a 20°C, A es la concentración de Chl-A, \\(F_{NPC}\\) es el factor de atenuación de la fotosíntesis debido a carencia de nutrientes, \\(F_L\\) es el factor de atenuación debido a carencia de luz, \\(𝑇\\) es la temperatura del agua en \\(ºC\\) y \\(\\theta_4\\) es el coeficiente de corrección por temperatura \\((\\theta_4 = 1.047)\\). El factor de atenuación por ausencia de nutrientes se calcula como: \\[\\begin{equation} F_{NPC} = min(F_A, F_P, F_C) \\tag{5.5} \\end{equation}\\] \\[\\begin{equation} F_N= \\frac{N_{NH3}+N_{NO3}}{N_{NH3}+N_{NO3}+k_{snp}} \\tag{5.6} \\end{equation}\\] \\[\\begin{equation} F_P= \\frac{P_i}{P_i+k_{spp}} \\tag{5.7} \\end{equation}\\] \\[\\begin{equation} F_C= \\frac{C_{tot}}{C_{tot}+k_{scp}} \\tag{5.7} \\end{equation}\\] donde k_{snp}, k_{spp}, k_{scp} son las constantes de semi-saturación para la correción por ausencia de nitrógeno, fósforo y carbono. El factor de atenuación por ausencia de lusz se calcula como: \\[\\begin{equation} F_L= \\frac{1}{k_eh}Ln() \\tag{5.8} \\end{equation}\\] "],["references.html", "References", " References "]]
